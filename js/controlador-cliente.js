var categorias = [
    {
        id: 1,
        nombreCategoria: "Pizzas",
        icono: "../img/iconoPizza.jpg",
        empresas: [
            {
                nombreEmpresa: "Pizza Hut",
                imagen: "../img/pizza-hut-banner.jpeg",
                logo: "../img/pizzaHutLogo.jpg",
                descripcion: "Pizzas-Pasta-Alitas",
                productos: [
                    {
                        nombreProducto: "Pizza de peperoni",
                        imgProducto: "../img/PizzaPeperoni.jpg",
                        descripcion: "Pizzas",
                        precio: 99.99
                    },
                    {
                        nombreProducto: "Pizza de jamon",
                        imgProducto: "../img/pizzajamon.jpg",
                        descripcion: "Pizzas",
                        precio: 150.99
                    },
                    {
                        nombreProducto: "Pizza 4 estaciones",
                        imgProducto: "../img/Pizza4estaciones.jpg",
                        descripcion: "Pizzas",
                        precio: 199.99
                    },
                ]
            },
            {
                nombreEmpresa: "Little Caesars",
                imagen: "../img/leattleCaesarBanner.jpg",
                logo: "../img/littleCaesarsLogo.png",
                descripcion: "Pizzas-Pasta-Alitas",
                productos: [
                    {
                        nombreProducto: "Pizza de peperoni",
                        imgProducto: "../img/PizzaPeperoni.jpg",
                        descripcion: "Pizzas",
                        precio: 100.99
                    },
                    {
                        nombreProducto: "Pizza de Jamon",
                        imgProducto: "../img/pizzajamon.jpg",
                        descripcion: "Pizzas",
                        precio: 150.99
                    },
                    {
                        nombreProducto: "4 estaciones",
                        imgProducto: "../img/Pizza4estaciones.jpg",
                        descripcion: "Pizzas",
                        precio: 200.99
                    },
                ]
            },
            {
                nombreEmpresa: "Dominos Pizza",
                imagen: "../img/BannerDominos.jpg",
                logo: "../img/DominosLogo.png",
                descripcion: "Pizzas-Pasta-Alitas",
                productos: [
                    {
                        nombreProducto: "Pizza de peperoni",
                        imgProducto: "../img/PizzaPeperoni.jpg",
                        descripcion: "Pizzas",
                        precio: 100.99
                    },
                    {
                        nombreProducto: "Pizza de peperoni",
                        imgProducto: "../img/pizzajamon.jpg",
                        descripcion: "Pizzas",
                        precio: 150.99
                    },
                    {
                        nombreProducto: "Pizza de peperoni",
                        imgProducto: "../img/Pizza4estaciones.jpg",
                        descripcion: "Pizzas",
                        precio: 200.99
                    },
                ]
            }
        ]
    },
    {
        id: 2,
        nombreCategoria: "Hamburguesas",
        icono: "../img/hamburguesaIcono.jpg",
        empresas: [
            {
                nombreEmpresa: "Mc Donalds",
                imagen: "../img/BannerMcdonald.jpg",
                logo: "../img/McdonaldLogo.jpg",
                descripcion: "Hamburguesas-bedidas-helados",
                productos: [
                    {
                        nombreProducto: "Big Mac",
                        imgProducto: "../img/BigMac.jpg",
                        descripcion: "Hamburguesas",
                        precio: 99.99
                    },
                    {
                        nombreProducto: "Cheese Burguer",
                        imgProducto: "../img/CheeseBurguerMcdonald.jpg",
                        descripcion: "Hamburguesas",
                        precio: 150.99
                    },
                    {
                        nombreProducto: "Doble cuarto de carne",
                        imgProducto: "../img/DobleCuartoMcdonald.jpg",
                        descripcion: "Hamburguesas",
                        precio: 250.99
                    },
                ]
            },
            {
                nombreEmpresa: "Burguer King",
                imagen: "../img/BannerBurguerKing.png",
                logo: "../img/BurguerKingLogo.png",
                descripcion: "Pizzas-Pasta-Alitas",
                productos: [
                    {
                        nombreProducto: "Whooper",
                        imgProducto: "../img/WHOPPERBK.png",
                        descripcion: "Hamburguesas",
                        precio: 250.99
                    },
                    {
                        nombreProducto: "Big King XL Sencilla",
                        imgProducto: "../img/BIG KING XL SENCILLA_BK.png",
                        descripcion: "Hamburguesas",
                        precio: 400.99
                    },
                    {
                        nombreProducto: "Mega Stacker Triple",
                        imgProducto: "../img/MEGA-STACKER-TRIPLEBK.png",
                        descripcion: "Hamburguesas",
                        precio: 350.99
                    },
                ]
            },
        ]
    },
    {
        id: 3,
        nombreCategoria: "Farmacias",
        icono: "../img/FarmaciasIcono.jpg",
        empresas: [
            {
                nombreEmpresa: "Farmacias Kielsa",
                imagen: "../img/KielsaBanner.jpg",
                logo: "../img/kielsaLogo.jpg",
                descripcion: "Medicamentos-Higiene-Suplementos",
                productos: [
                    {
                        nombreProducto: "Amoxicilina",
                        imgProducto: "../img/AmoxicilinaKielsa.jpg",
                        descripcion: "Medicamentos",
                        precio: 75.99
                    },
                    {
                        nombreProducto: "Alcohol Etilico",
                        imgProducto: "../img/AlcoholEtiKielsa.jpg",
                        descripcion: "Higiene",
                        precio: 80.99
                    },
                    {
                        nombreProducto: "Marcarilla",
                        imgProducto: "../img/Mascarilla.jpg",
                        descripcion: "Higiene",
                        precio: 10.99
                    },
                ]
            },
            {
                nombreEmpresa: "Farmacia Siman",
                imagen: "../img/FarmaciaSimanBanner.png",
                logo: "../img/SimanLogo.jpg",
                descripcion: "Medicamentos-Higiene-Suplementos",
                productos: [
                    {
                        nombreProducto: "Amoxicilina",
                        imgProducto: "../img/AmoxicilinaKielsa.jpg",
                        descripcion: "Medicamentos",
                        precio: 75.99
                    },
                    {
                        nombreProducto: "Alcohol Etilico",
                        imgProducto: "../img/AlcoholEtiKielsa.jpg",
                        descripcion: "Higiene",
                        precio: 80.99
                    },
                    {
                        nombreProducto: "Marcarilla",
                        imgProducto: "../img/Mascarilla.jpg",
                        descripcion: "Higiene",
                        precio: 10.99
                    },
                ]
            },
            {
                nombreEmpresa: "Punto Farma",
                imagen: "../img/PuntoFarmaBanner.png",
                logo: "../img/PuntoFarmaLogo.png",
                descripcion: "Medicamentos-Higiene-Suplementos",
                productos: [
                    {
                        nombreProducto: "Amoxicilina",
                        imgProducto: "../img/AmoxicilinaKielsa.jpg",
                        descripcion: "Medicamentos",
                        precio: 75.99
                    },
                    {
                        nombreProducto: "Alcohol Etilico",
                        imgProducto: "../img/AlcoholEtiKielsa.jpg",
                        descripcion: "Higiene",
                        precio: 80.99
                    },
                    {
                        nombreProducto: "Marcarilla",
                        imgProducto: "../img/Mascarilla.jpg",
                        descripcion: "Higiene",
                        precio: 10.99
                    },
                ]
            }
        ]
    },
    {
        id: 4,
        nombreCategoria: "Bebidas",
        icono: "../img/BebidasIcono.jpg",
        empresas: [
            {
                nombreEmpresa: "Coca Cola",
                imagen: "../img/CocaColaBanner.png",
                logo: "../img/CocaColaLogo.png",
                descripcion: "Bebidas Carbonatadas",
                productos: [
                    {
                        nombreProducto: "Coca Cola portatil",
                        imgProducto: "../img/CocaPortatil.jpg",
                        descripcion: "Bebida",
                        precio: 20.99
                    },
                    {
                        nombreProducto: "Coca Cola de lata",
                        imgProducto: "../img/cocaLata.webp",
                        descripcion: "Bebida",
                        precio: 15.99
                    },
                    {
                        nombreProducto: "Coca Cola 3 litros",
                        imgProducto: "../img/Coca3L.png",
                        descripcion: "Bebida",
                        precio: 50.99
                    },
                ]
            },
            {
                nombreEmpresa: "Pepsi Cola",
                imagen: "../img/PepsiBanner.jpg",
                logo: "../img/PepsiLogo.png",
                descripcion: "Bebidas Carbonatadas",
                productos: [
                    {
                        nombreProducto: "Pepsi portatil",
                        imgProducto: "../img/PepsiPortatil.png",
                        descripcion: "Bebida",
                        precio: 15.99
                    },
                    {
                        nombreProducto: "Pepsi de lata",
                        imgProducto: "../img/PepsiLata.png",
                        descripcion: "Bebida",
                        precio: 20.99
                    },
                    {
                        nombreProducto: "Pepsi 3 litros",
                        imgProducto: "../img/Pepsi3L.jpg",
                        descripcion: "PizBebidazas",
                        precio: 50.99
                    },
                ]
            },
            {
                nombreEmpresa: "Cervezas Corona",
                imagen: "../img/CoronaBanner.jpg",
                logo: "../img/CoronaLogo.png",
                descripcion: "Bebidas alcohólicas",
                productos: [
                    {
                        nombreProducto: "Corona Individual",
                        imgProducto: "../img/CoronaIndividual.jpg",
                        descripcion: "Bebida alcohólica",
                        precio: 70.99
                    },
                    {
                        nombreProducto: "Corona en lata",
                        imgProducto: "../img/CoronaLata.jpg",
                        descripcion: "Bebida alcohólica",
                        precio: 25.99
                    },
                    {
                        nombreProducto: "Six pack corona",
                        imgProducto: "../img/CoronaSixPack.jpg",
                        descripcion: "Bebida alcohólica",
                        precio: 250.99
                    },
                ]
            }
        ]
    },
    {
        id: 5,
        nombreCategoria: "Postres",
        icono: "../img/PostresIcono.jpg",
        empresas: [
            {
                nombreEmpresa: "Cinnabon",
                imagen: "../img/CinnabonBanner.webp",
                logo: "../img/cinnabonLogo.png",
                descripcion: "Postres",
                productos: [
                    {
                        nombreProducto: "Cinnabon Clasico",
                        imgProducto: "../img/cinnabonClassic.jpg",
                        descripcion: "Postre",
                        precio: 200.99
                    },
                    {
                        nombreProducto: "Cinnabon Cupcake",
                        imgProducto: "../img/cinnabonCupcakes2.jpg",
                        descripcion: "Postre",
                        precio: 150.99
                    },
                    {
                        nombreProducto: "Cinnabon Mini Pecan Bon",
                        imgProducto: "../img/cinnabonMiniPecan.jpg",
                        descripcion: "Postre",
                        precio: 70.99
                    },
                ]
            },
            {
                nombreEmpresa: "Basilios",
                imagen: "../img/basiliosBanner.jpg",
                logo: "../img/BasiliosLogo.png",
                descripcion: "Postres-Pasteles",
                productos: [
                    {
                        nombreProducto: "Pastel Helado",
                        imgProducto: "../img/BasiliosPastelHelado.jpg",
                        descripcion: "Pastel",
                        precio: 150.99
                    },
                    {
                        nombreProducto: "Pastel de Corazón",
                        imgProducto: "../img/BasiliosPastelCorazon.jpg",
                        descripcion: "Pastele",
                        precio: 350.99
                    },
                    {
                        nombreProducto: "Pastel tres leches",
                        imgProducto: "../img/Basilios3Leches.jpg",
                        descripcion: "Pastele",
                        precio: 250.99
                    },
                ]
            },
            {
                nombreEmpresa: "Dunkin Donouts",
                imagen: "../img/DKBanner.jpg",
                logo: "../img/DKLogo.png",
                descripcion: "Donuts-Café",
                productos: [
                    {
                        nombreProducto: "Media Docena",
                        imgProducto: "../img/DkmediaDocena.jpg",
                        descripcion: "Donuts",
                        precio: 186.99
                    },
                    {
                        nombreProducto: "Docena de donas",
                        imgProducto: "../img/DKDocena.png",
                        descripcion: "Donuts",
                        precio: 279.99
                    },
                    {
                        nombreProducto: "Dona + Café",
                        imgProducto: "../img/DKDonaCafe.jpg",
                        descripcion: "Donas y café",
                        precio: 59.99
                    },
                ]
            }
        ]
    }
];

function InicializarDatos() {
    localStorage.setItem('categorias', JSON.stringify(categorias));
}
InicializarDatos();

var usuarios = JSON.parse(localStorage.getItem('usuarios'))
var categoriasPortal = JSON.parse(localStorage.getItem('categorias'))
console.log(usuarios);
console.log(categoriasPortal);

function regresarAlandingPage() {
    sessionStorage.setItem('Usuario activo', "");
    window.location = "../Htmls/index.html"
}


function obtenerCliente() {
    var clienteActivo = sessionStorage.getItem('Usuario activo');
    console.log(clienteActivo);

    document.getElementById('inicarss').innerHTML = "Bienvenido/a " + clienteActivo;
    document.getElementById('presentacion').innerHTML = "Hola, " + clienteActivo
}
obtenerCliente();

function generarCategorias() {
    document.getElementById('contenedor-categorias').innerHTML = ""
    for (let i = 0; i < categoriasPortal.length; i++) {
        document.getElementById('contenedor-categorias').innerHTML +=
            `
            <button type="button" id="Carta-categoria" class="col-3 col-sm-5 col-md-4 col-lg-3 col-xl-2" onclick="empresasCategoria(${i})"  data-bs-toggle="modal" data-bs-target="#empresasModal">
                <img id="icono-categoria" src="${categoriasPortal[i].icono}" class="card-img-top rounded-circle" alt="...">
                <div class="card-body">
                    <p class="card-text">${categoriasPortal[i].nombreCategoria}</p>
                </div>
            </button>
        `
    }
}
generarCategorias();

function empresasCategoria(codigocategoria) {
    console.log(codigocategoria);
    document.getElementById('empresasModalLabel').innerHTML = `${categoriasPortal[codigocategoria].nombreCategoria}`

    document.getElementById('contenedor-empresas').innerHTML="";
    for(let i=0; i<categoriasPortal[codigocategoria].empresas.length;i++){
        document.getElementById('contenedor-empresas').innerHTML += 
        `
        <div id="empresa">
            <button id="btn-productos" data-bs-toggle="modal" data-bs-target="#modalproductos" onclick="listaProductos(${codigocategoria},${i})">
                <img id="banner-empresa" src="${categoriasPortal[codigocategoria].empresas[i].imagen}"alt="...">
                <div id="body-empresa" class="card-body">
                    <img id="logo-empresa" src="${categoriasPortal[codigocategoria].empresas[i].logo}" class="rounded-circle " alt="...">
                    <div>
                        <h2>${categoriasPortal[codigocategoria].empresas[i].nombreEmpresa}</h2>
                        <p>${categoriasPortal[codigocategoria].empresas[i].descripcion}</p>
                    </div>
                </div>
            </button>
        </div>
        `
    
    }

}

function listaProductos(codigocategoria,empresa){
    document.getElementById('contendor-producto').innerHTML = "";
    document.getElementById('modalproductosLabel').innerHTML = `${categoriasPortal[codigocategoria].empresas[empresa].nombreEmpresa}`

    for(let i=0; i<categoriasPortal[codigocategoria].empresas[empresa].productos.length; i++){
        document.getElementById('contendor-producto').innerHTML +=
        `<div id="producto">
            <div>
                <img class="img-producto rounded-circle" src="${categoriasPortal[codigocategoria].empresas[empresa].productos[i].imgProducto}" alt="img">
            </div>
            <div id="info-producto">
                <h2>${categoriasPortal[codigocategoria].empresas[empresa].productos[i].nombreProducto}</h2>
                <p>${categoriasPortal[codigocategoria].empresas[empresa].productos[i].descripcion}</p>
            </div>
            <div id="pedir-productos">
                <p>${categoriasPortal[codigocategoria].empresas[empresa].productos[i].precio}</p>
                <button id="btn-pedir" class="rounded-pill" onclick="abrirformularioPedir(${codigocategoria},${empresa},${i});">Pedir</button>
            </div>
        </div>

        `
    }

}

function abrirformularioPedir(categoria,empresa,producto) {
    document.getElementById('contenedor-orden1').classList.toggle('abrir-categorias');
    document.getElementById('contenedor-orden1').innerHTML = "";
    let Pproduct = categoriasPortal[categoria].empresas[empresa].productos[producto].nombreProducto;
    let Pdescripcion = categoriasPortal[categoria].empresas[empresa].productos[producto].descripcion;
    let Pprecio = categoriasPortal[categoria].empresas[empresa].productos[producto].precio;
    let Pcategoria = categoriasPortal[categoria].nombreCategoria;


    document.getElementById('contenedor-orden1').innerHTML = 
    `
    <div id="contenedor-orden2">
        <div id="titulo-orden">
            <h4 style="margin-right: 10px">${Pproduct}</h4>
            <p style="margin-left: 10px;">${Pprecio}</p>
        </div>
        <div class="flex-orden" style="justify-content: center;">
            <h5>Ingrese la cantidad</h5>
            <input id="input-orden" class="rounded-pill" type="text" placeholder="123">
        </div>
        <div class="flex-orden">
            <button id="btn-cerrarOrden" class="rounded-pill" type="button" onclick="cerrarFormulario()">Cancelar</button>
            <button id="btn-procesarOrden" class="rounded-pill" type="button" onclick="procesarOrden(${Pproduct},${Pdescripcion},${Pprecio})">Procesar
                orden</button>
        </div>
    </div>
    `
}
function cerrarFormulario() {
    document.getElementById('contenedor-orden1').classList.remove('abrir-categorias');
    document.getElementById('input-orden').value = "";
}

function procesarOrden(nombrePro,descriProd,Precio){
    let cantidad = document.getElementById('input-orden').value;
    var clienteActivo = sessionStorage.getItem('Usuario activo');
    console.log(clienteActivo);

    for(let i=0; usuarios.length; i++){
        if(usuarios[i].nombre == clienteActivo){
            let orden = 
            {
                nombreProducto: nombrePro,
                descripcion: descriProd,
                cantidad: cantidad,
                precio: Precio*cantidad
            }
            usuarios[i].ordenes.push(orden);
            localStorage.setItem('usuarios', JSON.stringify(usuarios));
        }
    }
}
